# VanBlog Version Management System

This directory contains a modular version management system for VanBlog, supporting both standard releases and CornWorld fork releases.

## Structure

- `index.js`: Main entry point and CLI handler
- `updateVersions.js`: Updates version in all package.json files
- `checkUpstream.js`: Checks if fork version is based on upstream version
- `generateChangelog.js`: Generates CHANGELOG.md
- `generateReleaseNotes.js`: Generates RELEASE_NOTES.md for GitHub releases
- `updateDocs.js`: Updates documentation with new version
- `createTag.js`: Creates and optionally pushes Git tags
- `scripts/`: Utility scripts and tests

## Usage

```bash
# Basic usage (auto-detects release type from version)
node src/version/index.js 1.0.0

# Specify a fork release
node src/version/index.js --type fork 1.0.0-corn.1

# Skip upstream check for fork releases
node src/version/index.js --skipUpstream 1.0.0-corn.1

# Skip documentation update
node src/version/index.js --skipDocs 1.0.0

# Skip git tag creation
node src/version/index.js --skipTag 1.0.0

# Show help
node src/version/index.js --help
```

## Supported Commit Formats

The system generates CHANGELOG.md and RELEASE_NOTES.md based on Git commit history, supporting:

### 1. Conventional Commits

Standard format used by many projects:

```
feat(component): add a new feature
fix: correct an issue
docs: update documentation
```

### 2. HadTeam Format

Format defined by [HadTeam Git Commit Protocol](https://raw.githubusercontent.com/HadTeam/Workflow-Regulation/refs/heads/main/git_commit_message.md):

```
[Feat] Add a new feature
[Fix] Correct an issue
[Feat&Refactor] Add feature and refactor code
```

Commits are automatically categorized and included in the changelog according to their type.

## Environment Variables

- `AUTO_PUSH_TAGS`: Set to 'true' to automatically push tags to remote (default: false)

## Workflow

1. Update version in all package.json files
2. For fork releases, check against upstream version
3. Generate changelog from Git commit history
4. Generate release notes
5. Update documentation
6. Create git tag

## Release Types

- **Standard Release**: Uses semantic versioning (e.g., `1.0.0`)
- **Fork Release**: Uses semantic versioning with `-corn.N` suffix (e.g., `1.0.0-corn.1`)

## Testing

To test the release note generation with sample commits:

```bash
pnpm release:test
```

This creates a temporary Git repository with both conventional commits and HadTeam format commits, and generates release notes to verify formatting.

## Integration with GitHub Actions

The release notes generated by this system will be used by GitHub Actions workflows to create GitHub releases.
